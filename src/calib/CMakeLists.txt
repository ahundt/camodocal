
if(VCHARGE_D3D)
basis_include_directories(../D3D)
endif(VCHARGE_D3D)

if(VCHARGE_VIZ)
if(GLUT_FOUND)
basis_include_directories(
  ${GLUT_INCLUDE_DIR}
)

endif(GLUT_FOUND)
endif(VCHARGE_VIZ)

basis_include_directories(
  ${CERES_INCLUDE_DIRECTORIES}
  ../D3D
  ../dbow2/DBoW2
  ../dbow2/DUtils
  ../dbow2/DUtilsCV
  ../dbow2/DVision
)

set(SRCS
    HandEyeCalibration.cc
    PlanarHandEyeCalibration.cc
)

if(OPENCV_FOUND)

list(APPEND SRCS
  CameraCalibration.cc
  CameraRigBA.cc
  CamOdoCalibration.cc
  CamOdoThread.cc
  CamOdoWatchdogThread.cc
  CamRigOdoCalibration.cc
  StereoCameraCalibration.cc
  utils.cc
)

set(CALIB_OPTIONAL_DEPENDENCIES

    ${OPENCV_CORE_LIBRARY}
    ${OPENCV_IMGPROC_LIBRARY}
    ${OPENCV_CALIB3D_LIBRARY}
    camodocal_camera_models
    camodocal_camera_systems
    camodocal_gpl
    camodocal_pose_graph
    camodocal_sparse_graph
    camodocal_visual_odometry
)
endif(OPENCV_FOUND)

camodocal_library(camodocal_calib SHARED ${SRCS})

camodocal_link_libraries(camodocal_calib
  ${CAMODOCAL_PLATFORM_UNIX_LIBRARIES}
  ${Boost_FILESYSTEM_LIBRARY}
  ${Boost_SYSTEM_LIBRARY}
  ${Boost_THREAD_LIBRARY}
  ${CALIB_OPTIONAL_DEPENDENCIES}
  ${CERES_LIBRARIES}
)

if(VCHARGE_D3D)
vcharge_link_libraries(camodocal_calib
  D3D
)
endif(VCHARGE_D3D)

if(VCHARGE_VIZ)
if(GLUT_FOUND)
camodocal_link_libraries(camodocal_calib
  ${CAMODOCAL_PLATFORM_UNIX_LIBRARIES}
  ${GLUT_glut_LIBRARY}
  ${GLUT_Xmu_LIBRARY}
  ${GLUT_Xi_LIBRARY} 
  ${OPENGL_gl_LIBRARY}
  ${OPENGL_glu_LIBRARY}
  overlay
)
endif(GLUT_FOUND)
endif(VCHARGE_VIZ)

camodocal_install(camodocal_calib)

if(OPENCV_FOUND)
camodocal_test(CamOdoCalibration)
camodocal_link_libraries(CamOdoCalibration_test 
  ${CAMODOCAL_PLATFORM_UNIX_LIBRARIES}
  camodocal_calib
)
endif(OPENCV_FOUND)


camodocal_test(HandEyeCalibration)
camodocal_link_libraries(HandEyeCalibration_test 
  ${CAMODOCAL_PLATFORM_UNIX_LIBRARIES}
  camodocal_calib
)

camodocal_test(PlanarHandEyeCalibration)
camodocal_link_libraries(PlanarHandEyeCalibration_test
  ${CAMODOCAL_PLATFORM_UNIX_LIBRARIES}
  camodocal_calib
)